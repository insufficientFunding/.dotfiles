local lualine_require = require('lualine_require')
local session_name = lualine_require.require('lualine.component'):extend()
local highlight = require('lualine.highlight')

function session_name:init(options)
   session_name.super.init(self, options)

   self.colors = {
      session = highlight.create_component_highlight_group({ fg = '#e0be7b' }, 'session_highlight', self.options),
      working_directory = highlight.create_component_highlight_group(
         { fg = '#7ba9e0' },
         'working_directory_highlight',
         self.options
      ),
   }
end

function session_name:update_status()
   local data
   local session = vim.v.this_session
   if session == nil or string.len(session) == 0 then
      data = vim.fn.fnamemodify(vim.fn.getcwd(), ':t')
      data = data and '󰉋 ' .. data or ''
      data = highlight.component_format_highlight(self.colors.working_directory) .. data
   else
      data = vim.fn.fnamemodify(session, ':t')
      data = data and '󰁪 ' .. data or ''
      data = highlight.component_format_highlight(self.colors.session) .. data
   end

   return data
end

return session_name
